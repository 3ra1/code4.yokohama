{% set collection = page.collection() %}
{% block stylesheets %}
    {% do
        assets.addCss('theme://css/common.css', 120) %}
    {% do
        assets.addCss('theme://css/activities.css', 120) %}
    {% do
        assets.addCss('theme://css/normalize.css', 120) %}
{% endblock %}

<div class="activities_list_container">

    {% if page.media.images != null %}
        {% set header_image_media = page.media.images | first %}
        <div class="activities_list_image_box">
            <a href="{{ page.url }}">
                <img class="activities_list_image" src="{{ header_image_media.url }}" alt=""/>
            </a>
        </div>
    {% endif %}

    <div class="activities_list_info">
        <div class="activities_list_date">
            <a href="{{ page.url }}">
                <time class="dt-published" datetime="{{ page.date|date("c") }}">
                    {{ page.date|date("Y") }}.{{ page.date|date("m") }}.{{ page.date|date("d") }}
                </time>
            </a>
        </div>

        <div class="activities_list_category">
            {% set count = 0 %}
            {% for category in page.taxonomy.category %}
                {#
                       activites.url で、~~~~/activities というURLが取れる（activities_itemからactivitiesにpage.patentが入って渡ってきているから）
                #}
                <a class="activities_list_category_item"
                   href="{{ activities.url|rtrim('/') }}/category{{ config.system.param_sep }}{{ category }}">{{ category }}</a>
                {% set pageCategory = category %}
                {% set count = count + 1 %}
                {% if count != count(page.taxonomy.category) %}
                    ,
                {% endif %}
            {% endfor %}
        </div>
    </div>

    <div class="activities_list_content">

        <a class="activities_list_title" href="{{ page.url }}">{{ page.title }}</a>

        {% if page.header.continue_link is sameas(false) %}
            {{ page.content }}
            {% if not truncate %}
                {% set show_prev_next = true %}
            {% endif %}

        {% elseif truncate and page.summary != page.content %}
            {# summaryがマルチバイト文字列をうまく処理できないのでsliceする。 #}
            {{ page.summary|length > 120 ? page.summary|slice(0, 120) ~ '...' : page.summary }}
            <p class="read_more_button">
                <a class="read_more_button" href="{{ page.url }}">{{ 'Read more'|t }}</a>
            </p>

        {% elseif truncate %}
            {{ page.content }}
            <p class="read_more_button">
                <a class="read_more_button" href="{{ page.url }}">{{ 'Read more'|t }}</a>
            </p>

        {% else %}
            {{ page.content }}
            {% if config.plugins.comments.enabled %}
                {% include 'partials/comments.html.twig' %}
            {% endif %}

            {% set show_prev_next = true %}
        {% endif %}
    </div>
</div>
